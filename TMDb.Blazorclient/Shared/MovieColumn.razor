<link href="css/custom/movie.css" rel="stylesheet" />  

@if (MovieData?.Count() > 0)
{
    <div class="container">
        <ul class="list-group">
            @foreach (MovieModel movie in MovieData)
            {   
                <li class="list-group-item">
                    <a href="/movie/@movie.Id">
                    
                        <div class="container">

                            <div class="row">

                                <div class="col-4">
                                    <img class="movieColumnImg" src="@($"https://www.themoviedb.org/t/p/original{moviePosterPath}")" alt="..."/>
                                </div>

                                <div class="col-8">
                                    <div class="d-inline-block">
                                        <h3>@movie.Title</h3>
                                        <p>@(movie.Overview)...</p>
                                    
                                    </div>
                                </div>

                            </div>

                        </div>          
                    </a>
                </li>
            }
        </ul>
    </div>
    
}
else
{
    <h3>No movies pal</h3>
}

@code {

    [Parameter]
    public List<MovieModel> MovieData { get; set; }

    [Inject]
    private HttpClient Http { get; set; }

    private string moviePosterPath { get; set; }

    protected override async Task OnInitializedAsync()
    {
        try
        {

            foreach (MovieModel movie in MovieData)
            {
                var jsonMovieResult = await Http.GetFromJsonAsync<JsonMovie>($"https://api.themoviedb.org/3/movie/{movie.ImdbId}?api_key=e2b956cab063805da8cbc849ca00d644");
                moviePosterPath = jsonMovieResult.poster_path;

                if (movie.Overview.Length > 100)
                {
                    movie.Overview = movie.Overview.Substring(0, 100);
                }
            }

        }
        catch (Exception ex)
        {
            System.Diagnostics.Debug.WriteLine($"Error: {ex}");
        }
        

    }
}
